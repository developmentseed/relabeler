(window.webpackJsonprelabeler=window.webpackJsonprelabeler||[]).push([[0],{104:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),l=a.n(o),i=a(81),s=a(32),c=a(20),p=a(34),u=a(67),d=a(29),m=a(68),b=a.n(m).a.scale("Set2").colors(10),y="FETCH_DATA_BEGIN",h="FETCH_DATA_SUCCESS",f="FETCH_DATA_FAILURE",v="SET_LABEL",O="UPDATE_DATA",g=function(){return{type:y}},j=function(e,t,a){return{type:h,payload:{fData:e,labels:t,label:a}}},E=function(e){return{type:f,payload:{error:e}}},k=function(e){return{type:v,payload:{label:e}}};function w(e){if(!e.ok)throw Error(e.statusText);return e}function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(a,!0).forEach(function(t){Object(d.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var I={data:{},loading:!0,error:null,labels:[]};var D="CHANGE_OPACITY",P="DOWNLOAD_FILE",L=function(e){return{type:P,payload:{download:e}}};function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(a,!0).forEach(function(t){Object(d.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var z={opacity:50,downloadFile:!1};var T=Object(p.c)({geojsonData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return C({},e,{loading:!0,error:null});case h:return C({},e,{loading:!1,data:t.payload.fData,labels:t.payload.labels,label:t.payload.label});case f:return C({},e,{loading:!1,error:t.payload.error,data:{}});case v:return C({},e,{label:t.payload.label});case O:return C({},e,{data:t.payload.fData});default:return e}},control:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return V({},e,{opacity:t.payload.opacity});case P:return V({},e,{downloadFile:t.payload.download});default:return e}}}),J=Object(p.d)(T,Object(p.a)(u.a)),N=a(12),F=a(13),_=a(17),Q=a(14),Z=a(16),A=(a(97),a(155)),B=a(80),M=a(77),G=a.n(M),U=a(78),R=a.n(U),X=a(149),q=a(3),H=a(107),W=a(150),Y=a(142),K=a(146),$=a(141),ee=a(52),te=a(76),ae=a.n(te),ne=a(139),re=a(140),oe=a(70),le=a.n(oe);function ie(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ie(a,!0).forEach(function(t){Object(d.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ie(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var ce=function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:se({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar,{justifyContent:"space-between",backgroundColor:e.palette.primary.main}),content:{flexGrow:1,marginLeft:-240,width:"calc(100% - ".concat(240,"px)")},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}},pe=function(e){function t(){return Object(N.a)(this,t),Object(_.a)(this,Object(Q.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.open,n=e.handleDrawerOpen;return r.a.createElement(ne.a,{position:"fixed",className:Object(q.a)(t.appBar,Object(d.a)({},t.appBarShift,a))},r.a.createElement(re.a,null,r.a.createElement($.a,{color:"inherit","aria-label":"open drawer",onClick:n,edge:"start",className:Object(q.a)(t.menuButton,a&&t.hide)},r.a.createElement(le.a,null)),r.a.createElement(Y.a,{variant:"h6",noWrap:!0},"Relabeler")))}}]),t}(n.Component),ue=Object(H.a)(ce)(pe),de=a(25),me=a(71),be=a.n(me),ye=a(72),he=a.n(ye),fe=a(73),ve=a(143),Oe=function(e){return e.loading?r.a.createElement("div",{style:{marginLeft:"calc(50% - 5px)",marginTop:"calc(100vh/2 - 65px)"}},r.a.createElement(ve.a,{size:80,color:"secondary"})):r.a.createElement("div",null)},ge=a(43),je=function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(_.a)(this,Object(Q.a)(t).call(this,e))).state={loading:!0},a.onLabelClick=a.onLabelClick.bind(Object(de.a)(a)),a.save=a.save.bind(Object(de.a)(a)),a.loadExtraStyles=a.loadExtraStyles.bind(Object(de.a)(a)),a}return Object(Z.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){var e=this,t={version:8,sources:{"raster-tiles":{type:"raster",tiles:ge.layers,tileSize:256}},layers:[{id:"tmsLayer",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:22}]},a={container:this.node,style:t,center:[0,0],zoom:0,attributionControl:!0};this.hoverId=0;var n=new be.a.Map(a);this.onMapRender=function(t){t.target&&t.target.loaded()&&e.setState({loading:!1})},n.on("render",this.onMapRender),n.on("load",function(){n.on("click","labels",e.onLabelClick),e.loadExtraStyles()}),n.on("mouseover","labels",function(e){n.getCanvas().style.cursor=e?"pointer":""}),this.map=n}},{key:"onLabelClick",value:function(e){var t=e.features[0],a=this.props.currentlabel,n=this.props.data;n.features=this.props.data.features.map(function(e){return e.properties.index===t.properties.index&&(e.properties.label[a.id]=e.properties.label[a.id]?0:1,e.properties.status=e.properties.status&&"no"!==e.properties.status?"no":"yes"),e}),this.map.getSource("labels").setData(n)}},{key:"componentWillReceiveProps",value:function(e){e.data&&e.currentlabel&&this.initLabels(e.data,e.currentlabel,e.opacity),e.downloadFile&&(this.save(),this.props.dispatch(L(!1)))}},{key:"save",value:function(){var e=this.map.getSource("labels")._data,t=new Blob([JSON.stringify(e)],{type:"application/json;charset=utf-8"});Object(fe.saveAs)(t,"labels.geojson")}},{key:"loadExtraStyles",value:function(){var e=this;ge.classes.forEach(function(t){t.layers.length>0&&(e.map.addLayer({id:t.name,type:"raster",source:{type:"raster",tiles:t.layers,minzoom:0,maxzoom:22}}),e.map.setLayoutProperty(t.name,"visibility","none"))})}},{key:"initLabels",value:function(e,t,a){var n=this,r=[["==",["number",["at",t.id,["array",["get","label"]]]],1],t.color],o=["case"].concat(r).concat(["black"]);if(this.map.getSource("labels"))this.map.setPaintProperty("labels","fill-color",o),this.map.setPaintProperty("labels","fill-opacity",a/100),this.map.setPaintProperty("labels-line","line-opacity",a/100),ge.classes.forEach(function(e,a){var r=e.name;n.map.getLayer(r)&&(n.map.setLayoutProperty(r,"visibility","none"),t.id===a&&n.map.setLayoutProperty(r,"visibility","visible"))});else{var l={id:"labels",source:"labels",type:"fill",paint:{"fill-color":o,"fill-opacity":a/100}},i={id:"labels-line",source:"labels",type:"line",paint:{"line-width":["match",["get","status"],"no",2,"yes",2,1],"line-color":["match",["get","status"],"no","#e77cff","yes","#e77cff","white"],"line-opacity":a/100}};e.features=e.features.map(function(e,t){return e.properties.index=t,e}),this.map.addSource("labels",{type:"geojson",data:e});var s=he()(e);this.map.fitBounds([[s[0],s[1]],[s[2],s[3]]]),this.map.addLayer(l),this.map.addLayer(i)}}},{key:"render",value:function(){var e=this,t=this.state.loading;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"map",style:{position:"absolute",top:0,rigt:0,left:0,zIndex:99,bottom:0,width:"100%",overflow:"hidden"},ref:function(t){return e.node=t}}),r.a.createElement(Oe,{loading:t}))}}]),t}(n.Component),Ee=Object(c.b)(function(e){return{data:e.geojsonData.data,loading:e.geojsonData.loading,error:e.geojsonData.error,labels:e.geojsonData.labels,currentlabel:e.geojsonData.label,opacity:e.control.opacity,downloadFile:e.control.downloadFile}})(je),ke=a(5),we=a(147),xe=a(148),Ce=a(145),Ie=a(152),De=a(153),Pe=a(74),Le=a.n(Pe),Se=a(106),Ve=function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(_.a)(this,Object(Q.a)(t).call(this,e))).onFilesChange=a.onFilesChange.bind(Object(de.a)(a)),a}return Object(Z.a)(t,e),Object(F.a)(t,[{key:"onFilesChange",value:function(e){this.props.dispatch(function(e){return function(t){t(g());var a=new FileReader;a.onload=function(e){var n=JSON.parse(a.result),r=n.features[0].properties.label.map(function(e,t){return{id:t,class:"Class ".concat(t+1),color:b[t%10]}});t(j(n,r,r[0]))},a.readAsText(e[0])}}(e))}},{key:"onFilesError",value:function(e,t){console.log("error code "+e.code+": "+e.message)}},{key:"render",value:function(){return r.a.createElement("div",{style:{padding:10}},r.a.createElement(Y.a,{variant:"caption",display:"block",gutterBottom:!0},"Load label-maker geojson file"),r.a.createElement(Se.a,null,r.a.createElement(Le.a,{className:"files-dropzone-list",onChange:this.onFilesChange,onError:this.onFilesError,accepts:[".geojson",".json"],maxFiles:1,maxFileSize:1e9,minFileSize:0,clickable:!0},r.a.createElement("input",{type:"submit",value:"Choose a file",style:{width:"210px",margin:"5px"}}))))}}]),t}(n.Component),ze=Object(c.b)(null)(Ve),Te=a(154),Je=a(151);function Ne(e){var t=e.children,a=e.open,n=e.value,o=r.a.useRef(null);return r.a.useEffect(function(){o.current&&o.current.update()}),r.a.createElement(Je.a,{PopperProps:{popperRef:o},open:a,enterTouchDelay:0,placement:"top",title:n},t)}var Fe=function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(_.a)(this,Object(Q.a)(t).call(this,e))).changeOpacityControl=a.changeOpacityControl.bind(Object(de.a)(a)),a}return Object(Z.a)(t,e),Object(F.a)(t,[{key:"changeOpacityControl",value:function(e,t){this.props.dispatch({type:D,payload:{opacity:t}})}},{key:"render",value:function(){var e=this.props.opacity;return r.a.createElement("div",{style:{width:"210px",margin:"5px"}},r.a.createElement(Y.a,{variant:"caption",display:"block",gutterBottom:!0},"Label opacity"),r.a.createElement(Se.a,{style:{padding:"3px"}},r.a.createElement(Te.a,{ValueLabelComponent:Ne,"aria-label":"label",defaultValue:e,onChange:this.changeOpacityControl})))}}]),t}(n.Component);var _e=Object(c.b)(function(e){return{opacity:e.control.opacity}})(Fe),Qe=function(e){function t(){var e;return Object(N.a)(this,t),(e=Object(_.a)(this,Object(Q.a)(t).call(this))).choseLabel=function(t,a){e.props.dispatch(k(t))},e.downloadFile=function(){e.props.dispatch(L(!0))},e.contentEditable=r.a.createRef(),e}return Object(Z.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.labels,o=t.currentlabel;return r.a.createElement("div",null,r.a.createElement(De.a,null,n.map(function(t,n){return r.a.createElement("div",{key:n},r.a.createElement(Ie.a,{selected:t.id===o.id,onClick:function(){e.choseLabel(t,n)},style:{paddingBottom:"2px",paddingTop:"2px"}},r.a.createElement(Ce.a,{item:!0,xs:12},r.a.createElement(Ce.a,{container:!0,justify:"center"},r.a.createElement(Ce.a,{item:!0,xs:8},r.a.createElement(Y.a,{className:a.title,color:"textSecondary",gutterBottom:!0},ge.classes[n].name||t.class)),r.a.createElement(Ce.a,{item:!0,xs:4},r.a.createElement("span",{style:{background:t.color,marginLeft:"5px"},className:a.legendSpan}))))),r.a.createElement(K.a,null))})),0===n.length?r.a.createElement(ze,null):null,r.a.createElement(we.a,null,n.length>0?r.a.createElement("div",null,r.a.createElement(_e,null),r.a.createElement("div",{style:{margin:"3px"}},r.a.createElement(xe.a,{variant:"outlined",onClick:this.downloadFile},"Download"))):null),r.a.createElement(K.a,null))}}]),t}(n.Component),Ze=Object(ee.a)(Object(c.b)(function(e){return{labels:e.geojsonData.labels,currentlabel:e.geojsonData.label}}),Object(ke.a)(function(e){return{title:{fontSize:12,alignItems:"center",marginTop:"5px"},legendSpan:{display:"block",height:"25px",width:"60px",textAlign:"center",alignItems:"center",color:"#808080"}}}))(Qe),Ae=function(e){function t(e){var a;Object(N.a)(this,t),(a=Object(_.a)(this,Object(Q.a)(t).call(this,e))).handleDrawerOpen=function(){a.setState({open:!0})},a.handleDrawerClose=function(){a.setState({open:!1})},a.state={open:!0};var n=window.location.href.split("?url=")[1];return a.props.dispatch(function(e){return function(t){return t(g()),fetch(e).then(w).then(function(e){return e.json()}).then(function(e){var a=e.features[0].properties.label.map(function(e,t){return{id:t,class:"Class ".concat(t+1),color:b[t%10]}});return t(j(e,a,a[0])),e}).catch(function(e){return t(E(e))})}}(n)),a}return Object(Z.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state.open;return r.a.createElement("div",{className:e.root},r.a.createElement(ue,{handleDrawerOpen:this.handleDrawerOpen,open:t}),r.a.createElement(W.a,{className:e.drawer,variant:"persistent",anchor:"left",open:t,classes:{paper:e.drawerPaper}},r.a.createElement("div",{className:e.drawerHeader},r.a.createElement(Y.a,{gutterBottom:!0,component:"h3"},"Classes"),r.a.createElement($.a,{onClick:this.handleDrawerClose},r.a.createElement(ae.a,null))),r.a.createElement(K.a,null),r.a.createElement(Ze,null)),r.a.createElement(Ee,{className:Object(q.a)(e.content)}))}}]),t}(n.Component),Be=Object(ee.a)(Object(c.b)(function(e){return{}}),Object(H.a)(ce))(Ae),Me=Object(B.a)({palette:{primary:G.a,secondary:R.a}}),Ge=function(e){function t(){return Object(N.a)(this,t),Object(_.a)(this,Object(Q.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){return r.a.createElement(X.a,{theme:Me},r.a.createElement(A.a,null),r.a.createElement(Be,null))}}]),t}(n.Component);l.a.render(r.a.createElement(c.a,{store:J},r.a.createElement(i.a,{basename:"/relabeler"},r.a.createElement(s.c,null,r.a.createElement(s.a,{exact:!0,component:Ge,path:"/"})))),document.getElementById("root"))},43:function(e){e.exports=JSON.parse('{"layers":["https://api.mapbox.com/v4/mapbox.satellite/{z}/{x}/{y}.jpg?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"],"classes":[{"name":"background","layers":[]},{"name":"hospital","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1m8u6etaioh1cqpvqybzo7q/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"university","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1mb4xu84p511cn3rgphhaf4/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"school","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1kthmph0c831clkebqdv1a6/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"place_of_worship","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1mc3rjp1j5o1cm3hbiuw81q/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"government","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1m8jad18u221cl6dbww317q/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"transportation","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1mayd0i3c7c1cp80c3dqnqe/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"commercial","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1l7bkkz0dz91clmhvzw0086/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"industry","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1majhp23btn1cp8elw5bgbo/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"sports","layers":["https://a.tiles.mapbox.com/styles/v1/devseed/ck1masnggal8a1cld82vstk2l/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q"]},{"name":"residential","layers":[]}]}')},88:function(e,t,a){e.exports=a(104)}},[[88,1,2]]]);
//# sourceMappingURL=main.f37b84f8.chunk.js.map